# 正方教务系统助手 PKUHSC 版
* Mike Huang

The helper of ZhengFang System PKUHSC 欢迎fork/star<br>
原项目具体参见：[*csdn-nghuyong*](http://blog.csdn.net/nghuyong/article/details/52203443)<br>
验证码识别模块来自：[*github-west*](https://github.com/west000/IdentifyVerificationCode.git)

## 1.项目定义
这个项目修改了原项目的一些请求参数以适应北医正方系统，并且利用验证码识别模块自动识别验证码

## 2.项目依赖
* 爬虫相关：requests
* 网页解析：lxml,　bs4
* 数据存储：peewee
* 数据库：Sqlite
* 图像处理：pillow

## 3.项目结构
1. ZhengFang.db 数据库
2. model.py 模型层，通过ORM与数据库相连
3. spider.py 业务层，网页爬虫，**项目入口**
4. parseHtml.py 业务层，网页解析工具
4. identifyCode.py 验证码自动识别


## 4.项目功能
### 4.1模拟登陆
目前验证码识别正确率约为40%，后台会尝试10次，如仍无法识别需要手动输入（测试情况良好）

### 4.2个人信息获取
通过教务系统个人信息页面，抓取，个人信息，并持久化保存到数据库中。

### 4.3课表获取
通过抓取的个人信息读到学生入学的年份，在结合当前时间，就可以知道能够抓取到哪些学期的课表。

例如学生2014年入学，当前是2016年8月，说明至少可以抓取到：

2014-2015年度 第 1 学期

2014-2015年度 第 2 学期

2015-2016年度 第 1 学期

2015-2016年度 第 2 学期

这4个学期的课表，当然由于现在是2016年8月，可能可以抓取到2016-2017年度第 1 学期课表，可以试着抓取。

将抓取到的课表持久化到数据库中。

### 4.4成绩查询

通过教务系统成绩查询页面中的“历年成绩”抓取，课程成绩，并持久化到数据库中

### 4.5分学期分学年绩点计算

根据抓取下来的成绩，通过（总的（学分*绩点）/总的学分）分别计算各个学期的绩点与各个学年的绩点

## 5 测试进度（*PKUHSC正方*）
* 2017-3-22 完成login, getStudentBaseInfo
* 2017-3-24 完成课表抓取测试
* 2017-3-29 完成成绩抓取测试
* 2017-3-29 完成成绩统计



